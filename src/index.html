<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Fluent Now - AI Language Learning</title>
    <!-- Marked.js for markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked@12.0.0/marked.min.js"></script>
    <!-- CSS -->
    <link rel="stylesheet" href="/css/main.css">
</head>
<body>
    <!-- Main Container -->
    <div id="main-container">
        <!-- Header Section -->
        <div id="header">
            <h1 id="main-title">Get Fluent Now 🌍</h1>
            <p id="subtitle">AI-powered language learning with Google Gemini</p>
        </div>

        <!-- Status Display -->
        <div id="status">🔑 Please enter your Gemini API key to enable AI chat</div>

        <!-- API Key Configuration -->
        <div id="api-section">
            <div id="api-input-container">
                <input 
                    type="password" 
                    id="gemini-api-key" 
                    placeholder="Enter your Gemini API key" 
                    autocomplete="off"
                >
                <button id="validate-key-btn" onclick="app.validateApiKey()">Validate Key</button>
                <button id="help-btn" onclick="app.showApiHelp()">❓ Get API Key</button>
            </div>
        </div>

        <!-- App Controls -->
        <div id="app-controls" style="display: none;">
            <!-- Model Selection -->
            <div id="model-section">
                <h3>🧠 AI Model</h3>
                <div id="model-options">
                    <label class="radio-option">
                        <input type="radio" name="model" value="flash-lite" checked onchange="app.updateModel()">
                        <span class="radio-label">
                            <strong>Gemini 1.5 Flash 8B</strong>
                            <small>Fastest, most cost-effective</small>
                        </span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="model" value="flash" onchange="app.updateModel()">
                        <span class="radio-label">
                            <strong>Gemini 1.5 Flash</strong>
                            <small>Balanced speed and quality</small>
                        </span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="model" value="pro" onchange="app.updateModel()">
                        <span class="radio-label">
                            <strong>Gemini 1.5 Pro</strong>
                            <small>Highest quality, slower</small>
                        </span>
                    </label>
                </div>
            </div>

            <!-- Language Configuration -->
            <div id="language-section">
                <div id="language-controls">
                    <div id="source-lang-control">
                        <label for="source-lang">📚 Story Language:</label>
                        <select id="source-lang" onchange="app.updateLanguages()">
                            <option value="Spanish">Spanish (español)</option>
                            <option value="French">French (français)</option>
                            <option value="Italian">Italian (italiano)</option>
                            <option value="German">German (Deutsch)</option>
                            <option value="Portuguese">Portuguese (português)</option>
                            <option value="Dutch">Dutch (Nederlands)</option>
                            <option value="Russian">Russian (русский)</option>
                            <option value="Japanese">Japanese (日本語)</option>
                            <option value="Korean">Korean (한국어)</option>
                            <option value="Chinese (Simplified)">Chinese (中文)</option>
                            <option value="Arabic">Arabic (العربية)</option>
                            <option value="English">English</option>
                        </select>
                    </div>
                    <div id="target-lang-control">
                        <label for="target-lang">🎯 Translate to:</label>
                        <select id="target-lang" onchange="app.updateLanguages()">
                            <option value="English">English</option>
                            <option value="Spanish">Spanish (español)</option>
                            <option value="French">French (français)</option>
                            <option value="Italian">Italian (italiano)</option>
                            <option value="German">German (Deutsch)</option>
                            <option value="Portuguese">Portuguese (português)</option>
                            <option value="Dutch">Dutch (Nederlands)</option>
                            <option value="Russian">Russian (русский)</option>
                            <option value="Japanese">Japanese (日本語)</option>
                            <option value="Korean">Korean (한국어)</option>
                            <option value="Chinese (Simplified)">Chinese (中文)</option>
                            <option value="Arabic">Arabic (العربية)</option>
                        </select>
                    </div>
                </div>
                <button id="swap-languages" onclick="app.swapLanguages()">🔄 Swap Languages</button>
            </div>

            <!-- Difficulty Level -->
            <div id="difficulty-section">
                <h3>📊 Difficulty Level (CEFR)</h3>
                <select id="difficulty-level">
                    <option value="A1">A1 - Complete Beginner</option>
                    <option value="A2">A2 - Elementary</option>
                    <option value="B1">B1 - Intermediate</option>
                    <option value="B2">B2 - Upper Intermediate</option>
                    <option value="C1">C1 - Advanced</option>
                </select>
            </div>

            <!-- Theme Selection -->
            <div id="theme-section">
                <h3>🎨 Story Theme</h3>
                <select id="story-theme">
                    <option value="daily_life">Daily Life</option>
                    <option value="travel">Travel & Adventure</option>
                    <option value="food">Food & Cooking</option>
                    <option value="friendship">Friendship & Relationships</option>
                    <option value="work">Work & Career</option>
                    <option value="shopping">Shopping & Money</option>
                    <option value="health">Health & Wellness</option>
                    <option value="hobbies">Hobbies & Entertainment</option>
                    <option value="family">Family & Home</option>
                    <option value="nature">Nature & Environment</option>
                    <option value="technology">Technology & Modern Life</option>
                    <option value="education">Education & Learning</option>
                    <option value="custom">Custom Theme</option>
                </select>
                <div id="custom-theme-container" style="display: none;">
                    <input 
                        type="text" 
                        id="custom-theme-input" 
                        placeholder="Describe your custom story theme..."
                    >
                </div>
            </div>

            <!-- Story Generation -->
            <div id="story-section">
                <button id="generate-story-btn" onclick="app.generateStory()">
                    ✨ Generate New Story
                </button>
                <div id="story-output"></div>
            </div>

            <!-- Translation Section -->
            <div id="translation-section" style="display: none;">
                <h3>🔤 Your Translation</h3>
                <textarea 
                    id="translation-input" 
                    placeholder="Type your translation here..."
                    rows="4"
                ></textarea>
                <div id="translation-controls">
                    <button id="submit-translation-btn" onclick="app.submitTranslation()">
                        🎯 Get Feedback
                    </button>
                    <button id="mini-lesson-btn" onclick="app.generateMiniLesson()" style="display: none;">
                        📚 Generate Mini Lesson
                    </button>
                </div>
                
                <!-- Results Tabs -->
                <div id="results-tabs" style="display: none;">
                    <div id="tab-buttons">
                        <button id="feedback-tab" class="tab-button active" onclick="app.switchTab('feedback')">
                            🎯 Feedback
                        </button>
                        <button id="lesson-tab" class="tab-button" onclick="app.switchTab('lesson')">
                            📚 Mini Lesson
                        </button>
                    </div>
                    <div id="tab-content">
                        <div id="feedback-tab-content" class="tab-panel active">
                            <div id="feedback-output"></div>
                        </div>
                        <div id="lesson-tab-content" class="tab-panel">
                            <div id="lesson-output"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Floating Chat Widget -->
        <div id="chat-widget">
            <div id="chat-toggle" onclick="app.toggleChat()">💬</div>
            <div id="chat-container" style="display: none;">
                <div id="chat-header">
                    <h4>🤖 AI Assistant</h4>
                    <button id="chat-close" onclick="app.toggleChat()">×</button>
                </div>
                <div id="chat-messages"></div>
                <div id="chat-input-container">
                    <input 
                        type="text" 
                        id="chat-input" 
                        placeholder="Ask about grammar, vocabulary, or translations..."
                        onkeypress="app.handleChatKeyPress(event)"
                    >
                    <button id="chat-send-btn" onclick="app.sendChatMessage()">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- API Help Modal -->
    <div id="help-modal" style="display: none;">
        <div id="help-content">
            <div id="help-header">
                <h2>🔑 Get Your Free Google Gemini API Key</h2>
                <button id="close-help" onclick="app.closeApiHelp()">×</button>
            </div>
            <div id="help-steps">
                <div class="help-step">
                    <h3>Step 1: Visit Google AI Studio</h3>
                    <p>Go to <a href="https://ai.google.dev/gemini-api/docs/api-key" target="_blank">ai.google.dev/gemini-api/docs/api-key</a></p>
                </div>
                <div class="help-step">
                    <h3>Step 2: Sign in</h3>
                    <p>Sign in with your Google account (it's free!)</p>
                </div>
                <div class="help-step">
                    <h3>Step 3: Create API Key</h3>
                    <p>Click "Get API key" → "Create API key in new project"</p>
                </div>
                <div class="help-step">
                    <h3>Step 4: Copy & Paste</h3>
                    <p>Copy the API key and paste it into the input field above</p>
                </div>
                <div class="help-note">
                    <p><strong>✅ Free tier includes:</strong> 15 requests per minute, 1 million tokens per day</p>
                    <p><strong>🔒 Privacy:</strong> Your API key is stored locally in your browser only</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script type="module" src="/js/app.js"></script>
</body>
</html>